![image](https://github.com/anhshidou/akasecctf-2024/assets/90485791/8e3e695f-00ee-45e0-983a-9cf3662ce62a)# Source

```
from random import getrandbits
from Crypto.Util.number import getPrime, bytes_to_long
from SECRET import FLAG

e = 2
p = getPrime(256)
q = getPrime(256)
n = p * q

m = bytes_to_long(FLAG)
cor_m = m - getrandbits(160)

if __name__ == "__main__":
    c = pow(m, e, n)
    print("n = {}\nc = {}\ncor_m = {}".format(n, c, cor_m))
```

# Ciphertext

```
n = 5113166966960118603250666870544315753374750136060769465485822149528706374700934720443689630473991177661169179462100732951725871457633686010946951736764639
c = 329402637167950119278220170950190680807120980712143610290182242567212843996710001488280098771626903975534140478814872389359418514658167263670496584963653
cor_m = 724154397787031699242933363312913323086319394176220093419616667612889538090840511507392245976984201647543870740055095781645802588721
```

# Phân tích

Đây là dạng bài partly known message của Coppersmith attack, mình sẽ sử dụng phương pháp tương tự bài viết [này](https://hackmd.io/@nomorecaffeine/By_SVppIh)

# Lời giải

```
sage: n = 51131669669601186032506668705443157533747501360607694654858221495287063747009347204436896304739911776611691794
....: 62100732951725871457633686010946951736764639
sage: c = 32940263716795011927822017095019068080712098071214361029018224256721284399671000148828009877162690397553414047
....: 8814872389359418514658167263670496584963653
sage: cor_m = 7241543977870316992429333633129133230863193941762200934196166676128895380908405115073922459769842016475438
....: 70740055095781645802588721
sage: P.<x> = PolynomialRing(Zmod(n))
sage: f = (cor_m + x)^2 - c
sage: f = f.monic()
sage: f.small_roots()
[731552839472047918013656821739561688326920972620]
```
Từ đó ta thu được m, viết chương trình decode:

```
from Crypto.Util.number import *

m = 724154397787031699242933363312913323086319394176220093419616667612889538090840511508123798816456249565557527561794657469972723561341

print(long_to_bytes(m))
```
# Flag
`AKASEC{c0pp3r5m17h_4774ck_1n_1ov3_w17h_5m4ll_3xp0n3nts}`
